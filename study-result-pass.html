<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Study Result</title>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
    />
    <meta name="theme-color" content="#000000" />
    <link rel="stylesheet" href="style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
    />
    <script
      src="https://unpkg.com/@dotlottie/player-component@latest/dist/dotlottie-player.mjs"
      type="module"
    ></script>
  </head>
  <body
    oncontextmenu="return false"
    onselectstart="return false"
    ondragstart="return false"
    onkeydown="return false"
  >
    <div class="container">
      <div id="checkResult" onclick="runCheckResult(1.02, 80,'baro')">
        <dotlottie-player
          src="src/lottie/treasure_box.json"
          background="transparent"
          speed="1"
          style="width: fit-content; height: 35dvh"
          loop
          autoplay
        ></dotlottie-player>
      </div>

      <div
        id="pass"
        class="animate__animated animate__fadeIn"
        style="display: none"
      >
        <div id="passPopup" class="result-popup d-none">
          <div class="earn-point">
            <div id="pointNum" class="point"></div>
            <div id="readingUnit" class="reading-unit pass-baro"></div>
          </div>
          <div class="ribbon-good-job"></div>
          <div class="score-container">
            <div class="txt-total-score">
              <span id="totalStudyScore"></span>/100
            </div>
            <div class="txt-message">Points Achived!</div>
          </div>
        </div>
        <div class="bg-effect pass"></div>
      </div>
    </div>

    <script>
      const checkResult = document.getElementById("checkResult");
      const pass = document.getElementById("pass");
      const passPopup = document.getElementById("passPopup");

      const pointNum = document.getElementById("pointNum");
      const totalStudyScoreNum = document.getElementById("totalStudyScore");
      const readingUnit = document.getElementById("readingUnit");

      const audioPass = new Audio("src/audio/study-result-pass.mp3");
      const audioFail = new Audio("src/audio/study-result-fail.mp3");

      const mobile = matchMedia("screen and (max-width: 1023px)");
      const tablet = matchMedia("(min-width: 1024px) and (max-width: 1440px)");

      function playAudioPass() {
        audioPass.play();
      }

      function runCheckResult(point, totalStudyScore, unitName) {
        let readingUnitImage = "pass-" + unitName;

        playAudioPass();

        pointNum.innerHTML = point;
        totalStudyScoreNum.innerHTML = totalStudyScore;
        readingUnit.className = "reading-unit " + readingUnitImage;

        checkResult.className = "d-none";
        pass.style.display = "flex";

        setTimeout(() => {
          passPopup.className =
            "result-popup d-block animate__animated animate__bounceIn";
        }, 1000);
      }

      if (mobile.matches) {
        passPopup.style.scale = 0.65;
      }
      if (tablet.matches) {
        passPopup.style.scale = 0.75;
      }
    </script>
  </body>
</html>
